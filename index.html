<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>XI-4 • elevenfourgengs — Official Website (Dark Gen Z, Optimized)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Website resmi Kelas 11-4 SMAN 1 Dolok Masihul — galeri, jadwal, roster, pengumuman, piket, siswa, agenda, hall of fame, aspirasi.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@600;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.7.0/fonts/remixicon.css" rel="stylesheet">
  <style>
/* ===========================
   XI-4 • Dark GenZ Styles (Optimized)
   =========================== */

/* tokens */
:root{
  --bg-900:#07070b;
  --bg-800:#0f1116;
  --panel: rgba(255,255,255,0.03);
  --card: rgba(18,22,30,0.62);
  --glass-border: 1px solid rgba(255,255,255,0.03);
  --accentA: #ff2fb3;
  --accentB: #6a5cff;
  --accentC: #00d4ff;
  --accentD: #22ffbb;
  --muted: rgba(255,255,255,0.88);
  --muted-weak: rgba(255,255,255,0.66);
  --radius-lg: 18px;
  --radius-sm: 10px;
  --shadow-1: 0 10px 30px rgba(0,0,0,0.6);
  --text-bg: rgba(0,0,0,0.55);
  --ui-gap: 14px;
}

/* reset & base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter,Poppins,"Segoe UI",Arial,sans-serif;
  background:
    radial-gradient(800px 360px at 80% 10%, rgba(106,92,255,0.04), transparent 12%),
    radial-gradient(700px 300px at 12% 88%, rgba(255,47,179,0.03), transparent 14%),
    linear-gradient(180deg,var(--bg-900),var(--bg-800));
  color:var(--muted);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  min-height:100vh;
  scroll-behavior:smooth;
  padding-bottom:84px; /* footer space */
  background-attachment:fixed;
}

body.no-scroll {
    overflow: hidden;
}

/* subtle scrollbar */
::-webkit-scrollbar{width:9px;background:transparent}
::-webkit-scrollbar-thumb{background:linear-gradient(120deg,var(--accentB),var(--accentA));border-radius:999px;border:2px solid rgba(0,0,0,0.4)}

/* container */
.container{max-width:1240px;margin:0 auto;padding:0 22px}
@media (max-width:700px){.container{padding:0 6vw}}

/* NAVBAR */
.header{position:sticky;top:12px;z-index:999;display:flex;justify-content:center;padding:8px 18px;background:transparent}
.navbar{
  width:100%;max-width:1240px;display:flex;align-items:center;justify-content:space-between;gap:12px;
  background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));
  border-radius:999px;padding:8px 12px;border:var(--glass-border);backdrop-filter:blur(6px);box-shadow:0 8px 28px rgba(0,0,0,0.45);
  min-height:62px;
}
.brand{display:flex;align-items:center;gap:12px}
.logo{
  width:56px;height:56px;border-radius:14px;overflow:hidden;background:linear-gradient(125deg,#08101a 0%,#151425 100%);display:flex;align-items:center;justify-content:center;font-weight:900;color:#fff;box-shadow:0 2px 8px rgba(106,92,255,0.06);border:1.5px solid rgba(255,255,255,0.03)
}
.brand .title{font-weight:900;font-size:1.05rem;letter-spacing:.02em;color:var(--muted)}
.brand .subtitle{font-size:.78rem;color:var(--muted-weak);margin-top:2px}
.navlinks a{color:var(--muted-weak);text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:700;transition:background .15s,color .15s,transform .12s;letter-spacing:.02em;font-size:.95rem}
.navlinks a.active, .navlinks a:hover{background:linear-gradient(90deg,var(--accentC),var(--accentA));color:#061018;transform:translateY(-3px);box-shadow:0 8px 30px rgba(0,0,0,0.45)}
.menu-toggle{display:none;background:transparent;border:0;color:var(--muted-weak);padding:8px 10px;border-radius:8px;font-weight:700;font-size:1.2rem; cursor:pointer;}

@media(max-width:900px){.menu-toggle{display:inline-flex; align-items:center;}}

/* HERO */
.hero{min-height:80vh;display:flex;align-items:center;justify-content:center;padding:46px 18px 54px;position:relative;overflow:hidden}
.hero-bg{position:absolute;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none;background:radial-gradient(500px 250px at 78% 16%, rgba(0,212,255,0.06), transparent 18%),radial-gradient(480px 220px at 14% 86%, rgba(255,47,179,0.04), transparent 18%);filter:blur(42px);opacity:.95}
.hero-card{
  width:100%;max-width:1240px;display:grid;grid-template-columns:1.15fr 420px;gap:48px;align-items:center;z-index:2;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:var(--radius-lg);padding:28px 28px;border:var(--glass-border);backdrop-filter:blur(6px);box-shadow:0 18px 44px rgba(0,0,0,0.6);
}
@media(max-width:1100px){.hero-card{grid-template-columns:1fr 320px;gap:30px;padding:22px}}
@media(max-width:900px){.hero-card{grid-template-columns:1fr;gap:18px;padding:18px}}

.hero-content h1{
  font-size:2.2rem;line-height:1.02;margin:0;font-weight:900;
  background:linear-gradient(90deg,var(--accentC) 45%, var(--accentA) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:.01em;
  text-shadow:0 6px 28px rgba(106,92,255,0.04)
}
.hero-lead{color:var(--muted-weak);margin-top:14px;font-size:1.02rem;line-height:1.55;font-weight:500; text-shadow: 1px 1px 3px rgba(0,0,0,0.5);}
.cta-row{margin-top:20px;display:flex;gap:12px;flex-wrap:wrap}
.cta-row .btn{font-size:1rem;border:none;padding:9px 14px;border-radius:12px;cursor:pointer;font-weight:800}
.cta-ghost{background:transparent;border:1.2px solid rgba(255,255,255,0.06);color:var(--muted-weak);padding:9px 14px}
.hero-structure{margin-top:18px;color:var(--muted-weak);font-size:1rem}
.hero-structure .badge{margin:3px 5px;background:linear-gradient(90deg,var(--accentB),var(--accentC));color:#061018;padding:6px 10px;border-radius:10px;font-weight:800;font-size:.9rem}

/* photo */
.hero-photo-wrap{position:relative;z-index:2;border-radius:12px;overflow:hidden;width:100%;max-width:420px;background:var(--card);display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.03);aspect-ratio:4/3}
.hero-photo{width:100%;height:100%;object-fit:cover;display:block;transition:transform .45s cubic-bezier(.2,.9,.3,1);filter:contrast(0.98) saturate(1.02)}
.hero-photo-wrap:hover .hero-photo{transform:scale(1.02) rotate(-0.4deg)}
.photo-caption{position:absolute;bottom:10px;left:12px;right:12px;color:var(--muted);font-size:.95rem;background:var(--text-bg);padding:8px 11px;border-radius:8px;backdrop-filter: blur(2px);z-index:4;box-shadow:0 1px 8px rgba(0,0,0,0.45)}

/* stats */
.stat-panel{display:flex;flex-direction:column;gap:10px;margin-bottom:10px}
.stat-card{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);
  display:flex;flex-direction:column;align-items:center;justify-content:center;min-width:110px;box-shadow:0 6px 20px rgba(0,0,0,0.45)
}
.stat-card .kicker{color:var(--accentA);font-weight:700;font-size:.88rem}
.stat-card .num{font-size:1rem;font-weight:900;color:var(--accentB);margin-top:6px}
.stat-card .desc{font-size:.88rem;color:var(--muted-weak);margin-top:6px}

/* WIDGETS */
.widgets-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin:18px 0 12px 0;z-index:1}
.widget-card{background:var(--card);border-radius:12px;padding:12px 14px;color:var(--muted);box-shadow:0 6px 18px rgba(0,0,0,0.6);font-family:'JetBrains Mono',monospace;font-size:0.98rem;min-width:160px;position:relative;overflow:hidden;border:var(--glass-border);transition:transform .14s ease,box-shadow .14s ease;opacity:0;transform:translateY(14px)}
.widget-card.visible{opacity:1;transform:none}
.widget-title{font-size:1rem;color:var(--accentC);font-family:'Poppins',Arial,sans-serif;margin-bottom:6px;font-weight:700}

/* sections & cards */
section{padding:28px 18px;border-radius:12px}
.section-title{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}
.section-title h2{font-size:1.2rem;background:linear-gradient(90deg,var(--accentC),var(--accentA));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.section-sub{color:var(--muted-weak);font-size:.95rem; text-shadow: 1px 1px 3px rgba(0,0,0,0.5);}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
.card{background:var(--card);padding:12px;border-radius:12px;border:var(--glass-border);box-shadow:0 10px 28px rgba(0,0,0,0.55);transition:transform .18s;overflow:hidden;opacity:0;transform:translateY(12px)}
.card.visible{opacity:1;transform:none}
.card:hover{transform:translateY(-6px);box-shadow:0 16px 40px rgba(0,0,0,0.75)}
.table-wrap{overflow:auto;border-radius:12px;border:var(--glass-border);margin-bottom:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005))}

/* roster table small */
th,td{padding:8px 10px;border-bottom:1px solid rgba(255,255,255,0.02);text-align:center;font-size:.98rem;color:var(--muted)}
th{background:transparent;font-weight:800}
tr.today{background:linear-gradient(90deg,var(--accentC) 0%,var(--accentA) 100%);color:#061018;font-weight:900}

/* badges & progress */
.badge{display:inline-block;background:linear-gradient(90deg,var(--accentA),var(--accentB));color:#061018;font-size:.88em;padding:6px 8px;border-radius:8px;font-weight:800;box-shadow:0 2px 6px rgba(0,0,0,0.5);margin-right:6px;border:1px solid rgba(255,255,255,0.03)}
.progress{background:rgba(255,255,255,0.03);height:10px;border-radius:7px;width:100%;margin-top:6px;overflow:hidden}
.progress-bar{background:linear-gradient(90deg,var(--accentC),var(--accentA));height:100%;border-radius:7px;transition:width .5s}

/* HALL OF FAME */
.hof-grid{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.hof-card{background:var(--card);border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,0.6);border:var(--glass-border);min-width:200px;max-width:280px;padding:12px;display:flex;flex-direction:column;align-items:center;transition:transform .16s}
.hof-card:hover{transform:scale(1.03)}
.hof-img{width:68px;height:68px;border-radius:50%;object-fit:cover;box-shadow:0 6px 18px rgba(0,0,0,0.6)}
.hof-coming-soon{width:68px;height:68px;border-radius:50%;background:linear-gradient(135deg,#222,#111);display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;font-weight:900;font-size:1.05em;border:2px dashed rgba(255,255,255,0.04)}

/* SISWA (2 columns on mobile) */
.siswa-controls { display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:12px }
.siswa-search { width:100%;max-width:420px;margin:0 auto;border:1px solid rgba(255,255,255,0.04);padding:10px 12px;border-radius:10px;font-size:1rem;background:transparent;color:var(--muted);outline:none;transition:border .12s}
.siswa-grid { display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; margin-top:12px; }
.siswa-card { background: linear-gradient(135deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); border-radius:12px; padding:10px; display:flex; flex-direction:column; align-items:center; min-height:110px; justify-content:flex-start; box-shadow:0 8px 28px rgba(0,0,0,0.55); transition: transform .18s; will-change: transform, opacity; opacity:0; transform: translateY(18px) }
.siswa-card.visible { opacity:1; transform: translateY(0); transition: opacity .45s ease, transform .4s ease }
.siswa-card:hover { transform: translateY(-6px) }
.siswa-avatar { width:58px; height:58px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:1.25rem; color:#061018; background:linear-gradient(140deg,var(--accentA),var(--accentC)); margin-bottom:8px; border:3px solid rgba(255,255,255,0.04); object-fit:cover; }
.siswa-name { font-weight:900; font-size:1rem; text-align:center; word-break: break-word; }
.siswa-role { font-size:.84rem; color:var(--accentC); margin-top:6px; text-align:center }

/* responsive grid: 2 columns on mobile */
@media (max-width:900px) { .siswa-grid { grid-template-columns: repeat(3, 1fr) } }
@media (max-width:600px) { .siswa-grid { grid-template-columns: repeat(2, 1fr) } .hero-content h1 { font-size:1.5rem } section { padding:16px 12px } }
@media (max-width:420px) { .siswa-grid { grid-template-columns: 1fr 1fr } }

/* FEEDBACK, QR, FAB, TOAST */
.feedback input, .feedback textarea { width:100%; font-size:1rem; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:var(--muted); margin-bottom:10px }
.feedback button { padding:10px 14px; background:linear-gradient(90deg,var(--accentB),var(--accentA)); color:#061018; border-radius:10px; border:none; font-weight:800; cursor:pointer }
.qr { margin-top:12px; display:flex; gap:12px; align-items:center }
.toast { position:fixed; bottom:28px; left:50%; transform:translateX(-50%); background:linear-gradient(90deg,var(--accentC),var(--accentB)); color:#061018; padding:12px 20px; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.6); z-index:9999; font-weight:800; opacity:0; pointer-events:none; transition:opacity .26s }
.toast.show { opacity:1; pointer-events:auto }

/* modal (lightbox) */
.modal { position:fixed; top:0; left:0; width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.78); z-index:10001; opacity:0; pointer-events:none; transition:opacity .18s }
.modal.open { opacity:1; pointer-events:auto }
.modal img { max-width:92vw; max-height:86vh; border-radius:10px; box-shadow:0 18px 46px rgba(0,0,0,0.8) }

/* helpers */
.hcenter { text-align:center }
.text-muted { color:var(--muted-weak) }
a:focus,button:focus,input:focus,textarea:focus { outline:3px solid rgba(0,212,255,0.12); outline-offset:3px; border-radius:8px }


/* --- CSS BARU UNTUK MENU MOBILE PROFESIONAL --- */
@media(max-width: 900px) {
    .navlinks {
      position: fixed;
      top: 0;
      right: -100%; /* Sembunyi di luar layar kanan */
      width: 280px;
      height: 100vh;
      padding: 24px;
      background: var(--bg-800);
      z-index: 1001;
      transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 12px;
      border-left: 1px solid var(--glass-border);
    }

    .navlinks.open {
      right: 0; /* Muncul ke dalam layar */
    }

    .nav-close {
      background: transparent;
      border: none;
      color: var(--muted);
      font-size: 1.5rem;
      position: absolute;
      top: 16px;
      right: 16px;
      cursor: pointer;
    }

    .nav-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(4px);
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }

    .nav-overlay.open {
      opacity: 1;
      pointer-events: auto;
    }
}

@media(min-width: 901px) {
    /* Sembunyikan elemen mobile di desktop */
    .nav-close, .nav-overlay {
        display: none;
    }
    /* Kembalikan style navlinks di desktop */
    .navlinks {
        position: static;
        height: auto;
        width: auto;
        background: none;
        flex-direction: row;
        border: none;
        padding: 0;
        right: 0;
        display: flex; /* Pastikan tetap terlihat di desktop */
    }
}

/* --- CSS BARU UNTUK MADING DIGITAL --- */
#mading-digital { padding: 32px 22px; }
.mading-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 16px;
}
.mading-card {
  background: var(--card);
  border: var(--glass-border);
  border-radius: var(--radius-sm);
  padding: 16px;
  box-shadow: var(--shadow-1);
}
.mading-card .timestamp {
  font-size: 0.8rem;
  color: var(--muted-weak);
  margin-bottom: 8px;
}
.mading-card .content {
  font-size: 1rem;
  line-height: 1.6;
  white-space: pre-wrap; /* Agar spasi dan enter tetap terlihat */
}
/* end style */
  </style>
</head>
<body>

<header class="header" role="banner">
  <div class="navbar container" role="navigation" aria-label="Main">
    <div class="brand">
      <div class="logo" id="logoWrap">
        <img id="logoImg" src="assets/1755172317026.jpg" alt="Logo Kelas" style="width:100%;height:100%;object-fit:cover" loading="lazy" onerror="this.src='https://via.placeholder.com/52?text=Logo'">
      </div>
      <div>
        <div class="title">Kelas 11-4 • elevenfourgengs</div>
        <div class="subtitle">SMAN 1 Dolok Masihul</div>
      </div>
    </div>

    <button class="menu-toggle" id="menuBtn" aria-controls="navlinks" aria-expanded="false">
      <i class="ri-menu-line"></i>
    </button>
  </div>

  <nav class="navlinks" id="navlinks" aria-label="Site">
    <button class="nav-close" id="navCloseBtn" aria-label="Tutup menu">
        <i class="ri-close-line"></i>
    </button>
    <a href="#top" class="active">Home</a>
    <a href="#about">Tentang</a>
    <a href="#roster">Roster</a>
    <a href="#piket">Piket</a>
    <a href="#gallery">Galeri</a>
    <a href="#siswa">Siswa</a>
    <a href="#agenda">Agenda</a>
    <a href="#hall-of-fame">Hall of Fame</a>
    <a href="#feedback">Aspirasi</a>
  </nav>

  <div class="nav-overlay" id="navOverlay"></div>
</header>

<section id="mading-digital" class="container">
  <div class="section-title">
    <h2>📢 Mading Digital XI-4</h2>
    <div class="section-sub">Informasi terbaru dan pengumuman penting. Di-update secara real-time.</div>
  </div>
  <div id="mading-content" class="mading-grid">
    <p class="text-muted">Memuat pengumuman terbaru...</p>
  </div>
</section>

<section class="hero" id="top" aria-label="Hero area">
  <div class="hero-bg" id="heroParallax" aria-hidden="true"></div>

  <div class="hero-card container" role="region">
    <div class="hero-content">
      <h1>
        <span>Selamat Datang di Website Resmi</span><br>
        <span class="text-bold" style="font-size:1.05em;">Kelas 11-4 SMAN 1 Dolok Masihul</span>
        <span class="type" id="type" aria-hidden="true"></span>
      </h1>

      <div class="hero-lead">
        Pusat informasi & dokumentasi XI-4: jadwal, piket, galeri, agenda, hall of fame, dan aspirasi. Desain ringan untuk HP, interaktif, dan mudah dipakai.
      </div>

      <div class="cta-row">
        <button class="btn" id="openGalleryBtn" style="background:linear-gradient(90deg,var(--accentA),var(--accentC));color:#061018;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:800;">📸 Lihat Galeri</button>
        <a class="btn cta-ghost" href="assets/1755172317055.jpg" download style="font-weight:800;">📥 Download Jadwal Pelajaran</a>
        <a class="btn cta-ghost" href="assets/1755172317062.jpg" download style="font-weight:800;">📥 Download Jadwal Piket</a>
      </div>

      <div class="hero-structure" aria-hidden="false" style="margin-top:14px;">
        <b style="display:block;margin-bottom:8px;">Struktur Kelas:</b>
        <span class="badge">Ketua: Jonnatan</span>
        <span class="badge" style="background:linear-gradient(90deg,var(--accentC),var(--accentA));color:#061018">Wakil: Muhammad Rio</span>
        <span class="badge" style="background:linear-gradient(90deg,var(--accentA),var(--accentB));color:#061018">Sekretaris: Dini</span>
        <span class="badge" style="background:linear-gradient(90deg,var(--accentB),var(--accentC));color:#061018">Bendahara: Karina</span>
      </div>
    </div>

    <div>
      <div class="stat-panel" aria-hidden="false">
        <div class="stat-card"><div class="kicker">Guru Wali</div><div class="num">Ibu Fauziah</div><div class="desc">Wali Kelas XI-4</div></div>
        <div class="stat-card"><div class="kicker">Jumlah Foto</div><div class="num" id="photoCount">0</div><div class="desc">Galeri</div></div>
        <div class="stat-card"><div class="kicker">Total Siswa</div><div class="num" id="stat-jml-siswa">35</div><div class="desc">Anggota</div></div>
        <div class="stat-card"><div class="kicker">Agenda Aktif</div><div class="num" id="stat-agenda">0</div><div class="desc">Upcoming</div></div>
      </div>

      <div class="hero-photo-wrap">
        <img class="hero-photo" src="assets/1755172317026.jpg" alt="Foto Bersama XI-4" loading="lazy">
        <div class="photo-caption">Foto bersama XI-4, 2025 • <b>Kebersamaan adalah kekuatan kita!</b></div>
      </div>
    </div>
  </div>
</section>

<section aria-label="Widgets">
  <div class="container">
    <div class="widgets-row">
      <div class="widget-card">
        <div class="widget-title">💡 Quotes Motivasi</div>
        <div class="widget-motivation" id="motivasi"></div>
      </div>

      <div class="widget-card">
        <div class="widget-title">⏰ Jam Digital</div>
        <div class="widget-time" id="jam" aria-live="polite"></div>
      </div>

      <div class="widget-card">
        <div class="widget-title">⏳ Menuju UTS</div>
        <div class="widget-countdown" id="countdown"></div>
      </div>

      <div class="widget-card widget-weather">
        <div class="widget-title">🌤️ Cuaca Sekarang</div>
        <div><span class="icon" id="cuaca-icon">🌤️</span> <span class="desc" id="cuaca-desc">Mengambil info cuaca...</span></div>
      </div>

      <div class="widget-card widget-vote">
        <div class="widget-title">📊 Voting: Kegiatan Favorit</div>
        <form id="voteForm">
          <label><input type="radio" name="vote" value="Ekskul"> Ekskul</label>
          <label><input type="radio" name="vote" value="Classmeeting"> Classmeeting</label>
          <label><input type="radio" name="vote" value="Studi Tur"> Studi Tur</label>
          <label><input type="radio" name="vote" value="Pensi"> Pensi</label>
          <label><input type="radio" name="vote" value="Bakti Sosial"> Bakti Sosial</label>
        </form>
        <div id="voteResult" style="margin-top:8px;font-weight:800;color:var(--accentC)"></div>
      </div>
    </div>
  </div>
</section>

<section id="about">
  <div class="container">
    <div class="section-title"><h2>Tentang Kelas</h2>
      <div class="section-sub">Pusat info, dokumentasi, dan pengumuman penting untuk seluruh anggota XI-4. Website ini menjadi ruang virtual yang menghubungkan seluruh siswa, wali kelas, dan admin.</div>
    </div>

    <div class="grid">
      <div class="card"><h3>Visi</h3><p>Mewujudkan lingkungan belajar yang solid, kreatif, dan saling mendukung baik akademik maupun non-akademik.</p></div>
      <div class="card"><h3>Misi</h3><p>• Menjadi media informasi utama kelas<br>• Mendokumentasikan kegiatan & prestasi<br>• Meningkatkan kekompakan kelas melalui kolaborasi & karya</p></div>
      <div class="card"><h3>Nilai Kelas</h3><p class="text-muted">Solidaritas • Tanggung Jawab • Kreativitas • Kedisiplinan • Respect</p></div>
    </div>
  </div>
</section>

<section id="roster" aria-label="Roster Pelajaran">
  <div class="container">
    <div class="section-title"><h2>Roster Pelajaran</h2>
      <div class="section-sub">Jadwal pelajaran mingguan. Download gambar jadwal untuk wallpaper HP agar tidak lupa!</div>
    </div>

    <div class="table-wrap" role="table">
      <table aria-label="Roster Pelajaran" style="width:100%;border-collapse:collapse">
        <thead>
            <tr>
                <th>Hari</th>
                <th>Mata Pelajaran</th>
            </tr>
        </thead>
        <tbody id="roster-body">
            </tbody>
      </table>
    </div>

    <div class="hcenter" style="margin-top:12px">
      <a class="btn cta-ghost" href="assets/1755172317055.jpg" download>📥 Download Gambar Jadwal</a>
    </div>
  </div>
</section>

<section id="piket" aria-label="Jadwal Piket">
  <div class="container">
    <div class="section-title"><h2>Jadwal Piket</h2>
      <div class="section-sub">Kelompok piket bergilir untuk menjaga kebersihan kelas. Baris highlight menandakan hari ini.</div>
    </div>
    <div class="table-wrap">
      <table aria-label="Jadwal Piket" style="width:100%;border-collapse:collapse">
        <thead><tr><th>Hari</th><th>Nama Siswa</th></tr></thead>
        <tbody id="piket-body"></tbody>
      </table>
    </div>
  </div>
</section>

<section id="gallery" aria-label="Galeri Kelas">
  <div class="container">
    <div class="section-title"><h2>Galeri</h2>
      <div class="section-sub">Momen seru, prestasi, ekskul, dokumentasi kebersamaan. Klik untuk memperbesar.</div>
      <div style="margin:12px 0 0 0;display:flex;gap:10px;flex-wrap:wrap">
        <button class="badge" onclick="filterGaleri('all')">Semua</button>
        <button class="badge" onclick="filterGaleri('Kebersamaan')">Kebersamaan</button>
        <button class="badge" onclick="filterGaleri('Ekskul')">Ekskul</button>
        <button class="badge" onclick="filterGaleri('Project')">Project</button>
      </div>
    </div>

    <div class="gallery" id="gallery-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin-top:12px">
      </div>
  </div>
</section>

<section id="siswa" aria-label="Daftar Siswa">
  <div class="container">
    <div class="section-title">
        <h2>Daftar Siswa</h2>
    </div>

    <div class="siswa-controls">
      <input id="siswa-search" class="siswa-search" type="text" placeholder="🔍 Cari nama siswa..." aria-label="Cari nama siswa">
      <select id="siswa-sort" aria-label="Urutkan siswa">
        <option value="az">Urutkan: A - Z</option>
        <option value="za">Urutkan: Z - A</option>
      </select>
    </div>
    
    <div class="hcenter" style="margin: 24px 0 12px 0;">
      <button id="lihatDenahBtn" class="btn cta-ghost">📍 Lihat Denah Tempat Duduk</button>
    </div>

    <div class="siswa-grid" id="siswa-grid" role="list">
      <p class="text-muted hcenter">Memuat daftar siswa...</p>
    </div>
  </div>
</section>

<section id="agenda">
  <div class="container">
    <div class="section-title"><h2>Agenda Kegiatan</h2>
      <div class="section-sub">Daftar event, lomba, dan tanggal penting. Semua info terbaru di bawah ini!</div>
    </div>
    <div id="agenda-list" class="grid"></div>
  </div>
</section>

<section id="hall-of-fame">
  <div class="container">
    <div class="section-title"><h2>Hall of Fame</h2>
      <div class="section-sub">Prestasi kelas XI-4, penghargaan, dan karya terbaik.</div>
    </div>

    <div class="hof-grid">
      <div class="hof-card card">
        <div class="hof-trophy" style="font-size:2rem;color:var(--accentA)">🏅</div>
        <div class="hof-coming-soon">Coming<br>Soon</div>
        <div class="hof-title" style="font-weight:800;margin-top:8px">Juara 1 Futsal</div>
        <div class="hof-desc text-muted" style="text-align:center;margin-top:6px">Prestasi terbaru XI-4.</div>
      </div>
      <div class="hof-card card">
        <div class="hof-trophy" style="font-size:2rem;color:var(--accentA)">🏅</div>
        <div class="hof-coming-soon">Coming<br>Soon</div>
        <div class="hof-title" style="font-weight:800;margin-top:8px">Karya Ilmiah Remaja</div>
        <div class="hof-desc text-muted" style="text-align:center;margin-top:6px">Tingkat Kabupaten</div>
      </div>
    </div>
  </div>
</section>

<section id="feedback">
  <div class="container">
    <div class="section-title"><h2>Aspirasi & Saran</h2>
      <div class="section-sub">Kirim masukan, kritik, atau ide untuk website dan kelas kita.</div>
    </div>

    <form class="feedback" action="https://formspree.io/f/xqalvelz" method="POST">
      <input type="text" name="Nama_Pengirim" id="fb-nama" placeholder="Nama (boleh anonim)" autocomplete="off" required>
      <textarea name="Isi_Aspirasi" id="fb-isi" placeholder="Tulis aspirasimu..." rows="3" required></textarea>
      <button type="submit">Kirim Aspirasi</button>
    </form>

    <div class="qr" aria-hidden="false" style="margin-top:16px">
      <div>
        <div style="font-weight:700;margin-bottom:6px;">Bagikan Website Ini</div>
        <div id="qrCode"></div>
      </div>
      <div style="font-size:.92em;color:var(--muted-weak);max-width:240px;margin-left:14px;">Scan atau share QR untuk membagikan website ini ke teman sekelas atau orang tua!</div>
    </div>
  </div>
</section>

<div class="modal" id="lightbox" aria-hidden="true" role="dialog" aria-label="Image preview" tabindex="-1">
  <img id="modalImg" src="#" alt="Preview">
</div>

<div class="fab-float" aria-hidden="false" style="position:fixed;right:18px;bottom:22px;z-index:999">
  <button class="fab" onclick="window.scrollTo({top:0,behavior:'smooth'})" title="Ke Atas" style="width:52px;height:52px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accentA),var(--accentC));color:#061018;border:none">↑</button>
</div>

<div class="toast" id="toast" role="status" aria-live="polite"></div>

<footer style="position:relative;background:transparent;padding:26px 18px 42px 18px;text-align:center;color:var(--muted-weak);">
  <div style="margin-bottom:8px;">
    <a href="https://instagram.com/elevenfourgengs" target="_blank" rel="noopener" style="color:var(--accentC);text-decoration:none;font-weight:600">Instagram @elevenfourgengs</a> • <a href="#contact" style="color:var(--muted-weak);text-decoration:none">Kontak</a>
  </div>
  <div style="font-size:.95rem;margin-bottom:14px;">© 2025 Kelas XI-4 SMAN 1 Dolok Masihul</div>
  <div style="font-size:.9rem;color:var(--muted-weak)"><strong>Dikembangkan oleh Alkahfi untuk seluruh elevenfourgengs</strong></div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js" defer></script>

<script type="module">
  // Import fungsi yang kita butuhkan dari Firebase SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";
  import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore.js";

  // Konfigurasi Firebase dari akun lo (SUDAH DIPERBAIKI)
  const firebaseConfig = {
    apiKey: "AIzaSyDxOGzerbdJXnUO93i7wjIWUYpeICu9kyw",
    authDomain: "elevenfourgengs.firebaseapp.com",
    projectId: "elevenfourgengs",
    storageBucket: "elevenfourgengs.firebasestorage.app",
    messagingSenderId: "322756405034",
    appId: "1:322756405034:web:a42662d8dcd420a91d2053",
    measurementId: "G-E6YJZP6BPX"
  };

  // Inisialisasi Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Ini "telinga" yang akan mendengarkan database pengumuman, diurutkan dari yang paling baru
  const q = query(collection(db, "pengumuman"), orderBy("tanggal", "desc"));
  onSnapshot(q, (querySnapshot) => {
    const pengumuman = [];
    querySnapshot.forEach((doc) => {
        pengumuman.push(doc.data());
    });
    // Kirim data ke fungsi renderMading di script utama
    window.renderMading(pengumuman);
  });
</script>
<script>
/* ====== Optimized interactions - Refactored ====== */

document.addEventListener('DOMContentLoaded', () => {

  /* Helpers */
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  // Fungsi Render Mading (dibuat global agar bisa diakses dari script module)
  window.renderMading = (pengumumanData) => {
      const madingContent = $('#mading-content');
      if (!madingContent) return;

      if (pengumumanData.length === 0) {
          madingContent.innerHTML = '<p class="text-muted">Belum ada pengumuman terbaru.</p>';
          return;
      }

      madingContent.innerHTML = pengumumanData.map(p => {
          // Cek dulu apakah p.tanggal itu ada dan valid
          const tanggal = p.tanggal && p.tanggal.toDate ? p.tanggal.toDate().toLocaleDateString('id-ID', {
              day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit'
          }) : 'Waktu tidak tersedia';
          
          const isi = p.isi || '[Tidak ada konten]';

          return `
            <div class="mading-card">
                <div class="timestamp">${tanggal} WIB</div>
                <div class="content">${isi.replace(/\n/g, '<br>')}</div>
            </div>
          `;
      }).join('');
  };

  /* Toast */
  function showToast(txt, duration = 2600){
    const el = $('#toast');
    if(!el) return;
    el.textContent = txt;
    el.classList.add('show');
    setTimeout(() => el.classList.remove('show'), duration);
  }
  
  // ===============================================
  // MAIN APP INITIALIZATION
  // ===============================================
  async function initializeApp() {
    try {
      const response = await fetch('data.json');
      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
      const data = await response.json();
      
      // Render content from data.json
      renderPiket(data.piket);
      renderAgenda(data.agenda);
      renderSiswa(data.siswa);
      renderGallery(data.galeri);
      renderStats(data);
      setupSiswaControls();

    } catch (error) {
      console.error("Gagal memuat data kelas:", error);
      showToast("Gagal memuat data. Coba refresh halaman.", 5000);
      $('#siswa-grid').innerHTML = '<p class="text-muted hcenter">Gagal memuat daftar siswa.</p>';
    }
    
    // Render content NOT from data.json
    renderRoster();
    setupStaticWidgets();
    setupEventListeners();
    observeElements();
  }

  // ===============================================
  // RENDER FUNCTIONS
  // ===============================================
  function renderStats(data) {
    if (data.galeri) $('#photoCount').textContent = data.galeri.length || 0;
    $('#stat-jml-siswa').textContent = '35'; // Static as requested
    if (data.agenda) $('#stat-agenda').textContent = data.agenda.length || 0;
  }
  
  function renderPiket(piketData) {
    const piketBody = $('#piket-body');
    if(!piketBody || !piketData) return;
    const today = (new Date().getDay() + 6) % 7; // Monday = 0
    piketBody.innerHTML = piketData.map((piket, i) => `
      <tr${today === i ? ' class="today"' : ''}>
        <td>${piket.hari}</td>
        <td>${piket.anggota.map(nama => `<span class="badge">${nama}</span>`).join(' ')}</td>
      </tr>
    `).join('');
  }

  function renderAgenda(agendaData) {
    const agendaList = $('#agenda-list');
    if(!agendaList || !agendaData) return;
    const formatDate = (str) => {
      const d = new Date(str);
      if(isNaN(d)) return str;
      const bulan = ["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];
      return `${d.getDate()} ${bulan[d.getMonth()]} ${d.getFullYear()}`;
    };
    agendaList.innerHTML = agendaData.map(item => `
      <div class="card">
        <div>
          <span class="badge">${item.kategori}</span>
          <span style="color:var(--accentA);font-weight:700;margin-left:8px">${formatDate(item.tanggal)}</span>
        </div>
        <div style="font-size:1.02rem;font-weight:800;color:#fff;margin-top:6px">${item.title}</div>
        <div style="color:var(--muted-weak);margin-top:6px">${item.desc}</div>
      </div>
    `).join('');
  }
  
  function renderSiswa(siswaData) {
    const siswaGrid = $('#siswa-grid');
    if(!siswaGrid || !siswaData) return;
    siswaGrid.innerHTML = ''; // Clear loading
    const avatarColors = ['00d4ff', 'ff2fb3', '6a5cff', '22ffbb', 'ffd600'];
    siswaData.forEach((siswa, index) => {
      const color = avatarColors[index % avatarColors.length];
      const card = document.createElement('div');
      card.className = 'siswa-card';
      card.dataset.name = siswa.nama;
      card.innerHTML = `
        <img class="siswa-avatar" src="https://via.placeholder.com/120/${color}/061018?text=${siswa.avatarInitial}" alt="Avatar ${siswa.nama}" width="58" height="58" loading="lazy">
        <div class="siswa-name">${siswa.nama}</div>
        <div class="siswa-role">Anggota XI-4</div>
      `;
      siswaGrid.appendChild(card);
    });
  }

  function renderGallery(galleryData) {
    const galleryGrid = $('#gallery-grid');
    if(!galleryGrid || !galleryData) return;
    galleryGrid.innerHTML = '';
    galleryData.forEach(item => {
        const card = document.createElement('div');
        card.className = 'item card';
        card.dataset.full = `assets/${item.url}`;
        card.dataset.cat = item.kategori;
        card.innerHTML = `
            <img loading="lazy" src="assets/${item.url}" alt="${item.alt}" style="width:100%;height:100%;object-fit:cover;border-radius:8px">
            <div class="tag" style="position:absolute; bottom:8px; left:8px; background:rgba(0,0,0,0.6); padding: 4px 8px; border-radius:6px; font-size:0.8rem;">${item.kategori}</div>`;
        galleryGrid.appendChild(card);
    });
  }
  
  function renderRoster() {
      const rosterBody = $('#roster-body');
      if (!rosterBody) return;

      const jadwal = {
        "Senin": ["Prakarya (2 les)", "Sosiologi (1 les)", "Fisika (2 les)", "Matematika (U) (2 les)", "B.Indonesia (2 les)"],
        "Selasa": ["B.Inggris (3 les)", "Sosiologi (1 les)", "Matematika (TL) (3 les)", "Sejarah (1 les)", "Seni Rupa (2 les)"],
        "Rabu": ["Matematika (U) (2 les)", "Geografi (2 les)", "Pjok (3 les)", "Agama (3 les)"],
        "Kamis": ["Geografi (3 les)", "Sosiologi (2 les)", "B.Indonesia (2 les)", "Sejarah (1 les)", "Ppkn (2 les)"],
        "Jum'at": ["Matematika (TL) (2 les)", "Sosiologi (1 les)", "Fisika (3 les)"]
      };

      let html = '';
      for (const hari in jadwal) {
          html += `<tr>`;
          html += `<td><b>${hari}</b></td>`;
          html += `<td>${jadwal[hari].join('<br>')}</td>`;
          html += `</tr>`;
      }
      rosterBody.innerHTML = html;
  }

  // ===============================================
  // STATIC WIDGETS
  // ===============================================
  function setupStaticWidgets() {
    // Motivasi
    const motivasiEl = $('#motivasi');
    if(motivasiEl){
      const texts = [
        "Jangan takut gagal, karena kegagalan adalah awal dari keberhasilan. 💪",
        "Kamu hebat! Teruslah berproses dan berkembang. 🚀",
        "Belajar hari ini, sukses esok hari! 📚",
        "Jangan menyerah sebelum sukses menjemputmu. 🏆",
        "Bersama kita kuat, bersama kita hebat!"
      ];
      const pick = () => { motivasiEl.textContent = texts[Math.floor(Math.random()*texts.length)]; };
      pick(); setInterval(pick,9000);
    }

    // Clock & Countdown
    const jamEl = $('#jam');
    if(jamEl){
      const clock = () => { const n=new Date(); jamEl.textContent = `${String(n.getHours()).padStart(2,'0')}:${String(n.getMinutes()).padStart(2,'0')}:${String(n.getSeconds()).padStart(2,'0')}`; };
      clock(); setInterval(clock,1000);
    }
    const countEl = $('#countdown');
    if(countEl){
      const updateCountdown = () => {
        const uts = new Date('2025-09-14T07:00:00');
        const diff = uts - new Date();
        if(diff <= 0){ countEl.textContent = 'UTS sudah selesai!'; return; }
        const days = Math.floor(diff/(1000*60*60*24));
        const hours = Math.floor((diff/(1000*60*60))%24);
        const mins = Math.floor((diff/(1000*60))%60);
        countEl.textContent = `${days} hari, ${hours} jam, ${mins} menit`;
      };
      updateCountdown(); setInterval(updateCountdown,30000);
    }

    // Weather
    const iconEl = $('#cuaca-icon');
    const descEl = $('#cuaca-desc');
    if(iconEl && descEl){
      fetch('https://api.open-meteo.com/v1/forecast?latitude=3.474&longitude=99.033&current_weather=true')
      .then(r => r.ok ? r.json() : Promise.reject())
      .then(d => {
        if(!d || !d.current_weather) throw 'no data';
        const c = d.current_weather;
        const codes = {0:"☀️ Cerah",1:"🌤️ Cerah",2:"⛅ Berawan",3:"☁️ Mendung",45:"🌫️ Kabut",51:"🌧️ Gerimis",61:"🌦️ Hujan",80:"🌧️ Hujan"};
        const icon = codes[c.weathercode] || '🌤️ Cerah';
        iconEl.textContent = icon.split(' ')[0];
        descEl.innerHTML = `Dolok Masihul<br>${Math.round(c.temperature)}°C, ${icon.replace(/^[^\s]+\s/,'')}`;
      }).catch(_=>{
        iconEl.textContent = '🌤️';
        descEl.innerHTML = 'Dolok Masihul<br>27°C, Cerah';
      });
    }
  }

  // ===============================================
  // EVENT LISTENERS
  // ===============================================
  function setupEventListeners() {
    // Parallax
    const heroBg = $('#heroParallax');
    if(heroBg) window.addEventListener('scroll', () => { heroBg.style.transform = `translateY(${window.scrollY * 0.16}px)`; }, { passive: true });

    // Menu Toggle
    const menuBtn = $('#menuBtn');
    const navlinks = $('#navlinks');
    const navCloseBtn = $('#navCloseBtn');
    const navOverlay = $('#navOverlay');

    const openMenu = () => {
        navlinks.classList.add('open');
        navOverlay.classList.add('open');
        document.body.classList.add('no-scroll');
        menuBtn.setAttribute('aria-expanded', 'true');
    };

    const closeMenu = () => {
        navlinks.classList.remove('open');
        navOverlay.classList.remove('open');
        document.body.classList.remove('no-scroll');
        menuBtn.setAttribute('aria-expanded', 'false');
    };

    if (menuBtn && navlinks && navCloseBtn && navOverlay) {
        menuBtn.addEventListener('click', openMenu);
        navCloseBtn.addEventListener('click', closeMenu);
        navOverlay.addEventListener('click', closeMenu);
    }

    // Gallery & Lightbox
    window.filterGaleri = (cat) => {
      $$('#gallery-grid .item').forEach(item => { item.style.display = (cat==='all' || item.dataset.cat===cat) ? '' : 'none'; });
    };
    $('#openGalleryBtn').addEventListener('click', () => {
        document.getElementById('gallery').scrollIntoView({ behavior: 'smooth' });
    });
    const gallery = $('#gallery-grid');
    const lightbox = $('#lightbox');
    const modalImg = $('#modalImg');
    if(gallery && lightbox && modalImg) {
      gallery.addEventListener('click', (e) => {
        const item = e.target.closest('.item');
        if(!item) return;
        modalImg.src = item.dataset.full;
        lightbox.classList.add('open');
        lightbox.setAttribute('aria-hidden','false');
      });
      lightbox.addEventListener('click', (e) => {
        if(e.target === lightbox) { lightbox.classList.remove('open'); lightbox.setAttribute('aria-hidden','true'); }
      });
    }
    window.addEventListener('keydown', (e) => { if(e.key === 'Escape' && lightbox.classList.contains('open')) lightbox.click(); });
    
    // Denah duduk
    const denahBtn = $('#lihatDenahBtn');
    if (denahBtn) {
      denahBtn.addEventListener('click', () => {
        const lightbox = $('#lightbox');
        const modalImg = $('#modalImg');
        if (lightbox && modalImg) {
          modalImg.src = 'assets/1755172317014.jpg';
          lightbox.classList.add('open');
          lightbox.setAttribute('aria-hidden', 'false');
        }
      });
    }

    // Feedback Form (sudah terhubung ke Formspree)
    const feedbackForm = $('#feedbackForm');
    if(feedbackForm) {
      feedbackForm.addEventListener('submit', e => {
        e.preventDefault();
        const form = e.target;
        const data = new FormData(form);
        fetch(form.action, {
          method: form.method,
          body: data,
          headers: { 'Accept': 'application/json' }
        }).then(response => {
          if (response.ok) {
            showToast('Aspirasi berhasil terkirim! Terima kasih.');
            form.reset();
          } else {
            showToast('Oops! Gagal mengirim aspirasi. Coba lagi.');
          }
        }).catch(error => {
          showToast('Oops! Ada masalah jaringan. Coba lagi.');
        });
      });
    }
    
    // Voting Form
    const voteForm = $('#voteForm');
    if(voteForm) {
        let voteCount = {Ekskul:2, Classmeeting:3, "Studi Tur":1, Pensi:4, "Bakti Sosial":2};
        voteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const val = voteForm.vote && voteForm.vote.value;
            if(!val) { showToast('Pilih opsi dulu ya!'); return; }
            voteCount[val] = (voteCount[val]||0) + 1;
            const total = Object.values(voteCount).reduce((a,b)=>a+b,0);
            const text = Object.entries(voteCount).map(([k,v])=>`${k}: ${Math.round(v/total*100)}%`).join(' • ');
            $('#voteResult').innerHTML = 'Hasil: ' + text;
            showToast('Terima kasih sudah voting!');
        });
    }

    // QR Code
    const makeQR = () => {
      if(typeof QRCode !== 'undefined'){
        $('#qrCode').innerHTML = '';
        new QRCode($('#qrCode'), { text: window.location.href, width: 86, height: 86, colorDark : "#00d4ff", colorLight : "#ffffff", correctLevel : QRCode.CorrectLevel.H });
      }
    };
    if(window.QRCode) makeQR();
    else window.addEventListener('load', () => setTimeout(makeQR, 500));
  }
  
  // ===============================================
  // SISWA SEARCH & SORT
  // ===============================================
  function setupSiswaControls() {
    const grid = $('#siswa-grid');
    if(!grid) return;
    const search = $('#siswa-search');
    const sort = $('#siswa-sort');
    
    function applyFilterAndSort(){
      const q = search.value.trim().toLowerCase();
      const order = sort.value || 'az';
      const cards = Array.from(grid.children);

      cards.forEach(card => {
        if (!card.dataset.name) return;
        const name = card.dataset.name.toLowerCase();
        const isVisible = name.includes(q);
        card.style.display = isVisible ? '' : 'none';
      });
      
      const visibleCards = cards.filter(card => card.style.display !== 'none');
      visibleCards.sort((a,b) => {
        const na = a.dataset.name.toLowerCase();
        const nb = b.dataset.name.toLowerCase();
        return order === 'az' ? na.localeCompare(nb) : nb.localeCompare(na);
      });
      
      visibleCards.forEach(card => grid.appendChild(card));
    }
    
    search.addEventListener('input', applyFilterAndSort);
    sort.addEventListener('change', applyFilterAndSort);
  }

  // ===============================================
  // INTERSECTION OBSERVER for Lazy Load & Reveal
  // ===============================================
  function observeElements() {
    if('IntersectionObserver' in window){
      const revealObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if(entry.isIntersecting){
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1, rootMargin: '0px 0px -10% 0px' });
      
      $$('.widget-card, .card, .siswa-card, .item').forEach(el => revealObserver.observe(el));
    } else {
      $$('.widget-card, .card, .siswa-card, .item').forEach(el => el.classList.add('visible'));
    }
  }

  // START THE APP
  initializeApp();

});
</script>

</body>
</html>
